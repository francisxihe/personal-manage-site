import{j as e,S as A,I as w,aS as B,X as N,B as b,Y as S,r as E,a4 as h}from"./index.295caa00.js";import"./index.768e466f.js";import{D as k}from"./index.88ba4d8f.js";import{I as V,U as y,S as Y}from"./IconSelector.c2144de5.js";import{T as M}from"./TagInput.a27bce1c.js";import{useTodoAllContext as g,TodoAllProvider as R}from"./context.b7a83c26.js";import{M as L,F as f}from"./index.6dcfb420.js";import{C as j}from"./index.d0e2df9e.js";/* empty css              */import{T as I}from"./index.1ba7cba6.js";import{T as D}from"./api.b8516001.js";import{o as C}from"./OpenModal.e0b23f17.js";import _ from"./index.51bf1366.js";import{A as O}from"./index.43e76df7.js";import"./pad.b909f4f4.js";import"./b-tween.es.d368a2a1.js";import"./index.75d02bbe.js";import"./x.aabcad2e.js";import"./createInjectState.49530c1b.js";import"./startOfDay.a6eae802.js";import"./radio.d5ff39d6.js";import"./context.b0281150.js";var a="/Users/xuwenhua/code/project/home-manage/src/pages/todo/todo-all/TodoFilters.tsx";const P=k.RangePicker,{Row:U,Col:x}=S;function $(){const{getTodoList:p,filters:u,setFilters:d,clearFilters:t}=g();return e.exports.jsxDEV(A,{className:"w-full my-3",direction:"vertical",size:"large",children:e.exports.jsxDEV(U,{gutter:[16,16],children:[e.exports.jsxDEV(x,{flex:"auto",span:6,children:e.exports.jsxDEV(w,{prefix:e.exports.jsxDEV(B,{},void 0,!1,{fileName:a,lineNumber:29,columnNumber:21},this),placeholder:"\u5173\u952E\u5B57",value:u.keyword,onChange:i=>{d(l=>({...l,keyword:i}))}},void 0,!1,{fileName:a,lineNumber:28,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:27,columnNumber:9},this),e.exports.jsxDEV(x,{flex:"auto",span:12,children:e.exports.jsxDEV(P,{placeholder:["\u8BA1\u5212\u5F00\u59CB\u65E5\u671F","\u8BA1\u5212\u7ED3\u675F\u65E5\u671F"],value:[u.planDateStart,u.planDateEnd],onChange:i=>{d(l=>({...l,planDateStart:i[0],planDateEnd:i[1]}))}},void 0,!1,{fileName:a,lineNumber:41,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:40,columnNumber:9},this),e.exports.jsxDEV(x,{span:6,children:e.exports.jsxDEV(N,{value:u.importance,onChange:i=>{d(l=>({...l,importance:i}))},allowClear:!0,placeholder:"\u91CD\u8981\u7A0B\u5EA6",children:[...Array.from(V.entries())].map(([i,{label:l}])=>e.exports.jsxDEV(N.Option,{value:i,children:l},i,!1,{fileName:a,lineNumber:67,columnNumber:17},this))},void 0,!1,{fileName:a,lineNumber:54,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:53,columnNumber:9},this),e.exports.jsxDEV(x,{span:6,children:e.exports.jsxDEV(N,{value:u.urgency,onChange:i=>{d(l=>({...l,urgency:i}))},allowClear:!0,placeholder:"\u7D27\u6025\u7A0B\u5EA6",children:[...Array.from(y.entries())].map(([i,{label:l}])=>e.exports.jsxDEV(N.Option,{value:i,children:l},i,!1,{fileName:a,lineNumber:87,columnNumber:15},this))},void 0,!1,{fileName:a,lineNumber:75,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:74,columnNumber:9},this),e.exports.jsxDEV(x,{span:6,children:e.exports.jsxDEV(N,{value:u.status,onChange:i=>{d(l=>({...l,status:i}))},allowClear:!0,placeholder:"\u5F85\u529E\u72B6\u6001",children:[e.exports.jsxDEV(N.Option,{value:"todo",children:"\u672A\u5B8C\u6210"},void 0,!1,{fileName:a,lineNumber:105,columnNumber:13},this),e.exports.jsxDEV(N.Option,{value:"done",children:"\u5DF2\u5B8C\u6210"},void 0,!1,{fileName:a,lineNumber:106,columnNumber:13},this),e.exports.jsxDEV(N.Option,{value:"abandoned",children:"\u5DF2\u653E\u5F03"},void 0,!1,{fileName:a,lineNumber:107,columnNumber:13},this)]},void 0,!0,{fileName:a,lineNumber:94,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:93,columnNumber:9},this),e.exports.jsxDEV(x,{span:6,children:e.exports.jsxDEV(M,{value:u.tags,onChange:i=>{d(l=>({...l,tags:i}))},placeholder:"\u6807\u7B7E"},void 0,!1,{fileName:a,lineNumber:111,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:110,columnNumber:9},this),e.exports.jsxDEV(x,{span:6,className:"",children:e.exports.jsxDEV("div",{className:"flex justify-end gap-2",children:[e.exports.jsxDEV(b,{onClick:async()=>{t()},children:"\u91CD\u7F6E"},void 0,!1,{fileName:a,lineNumber:124,columnNumber:13},this),e.exports.jsxDEV(b,{type:"primary",onClick:async()=>{await p()},children:"\u67E5\u8BE2"},void 0,!1,{fileName:a,lineNumber:131,columnNumber:13},this)]},void 0,!0,{fileName:a,lineNumber:123,columnNumber:11},this)},void 0,!1,{fileName:a,lineNumber:122,columnNumber:9},this)]},void 0,!0,{fileName:a,lineNumber:26,columnNumber:7},this)},void 0,!1,{fileName:a,lineNumber:25,columnNumber:5},this)}var o="/Users/xuwenhua/code/project/home-manage/src/pages/todo/todo-all/TodoTable.tsx";function G(){const{todoList:p,getTodoList:u}=g();E.exports.useEffect(()=>{async function s(){await u(),p.forEach(n=>{v(m=>({...m,[n.id]:"unLoading"}))})}s()},[]);const d=[{title:"\u5F85\u529E",dataIndex:"name",key:"name"},{title:"\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u72B6\u6001",key:"status",render:(s,n)=>{switch(n.status){case"done":return e.exports.jsxDEV("div",{className:"text-success",children:["\u5DF2\u5B8C\u6210(",h(n.doneAt).format("YYYY-MM-DD HH:mm"),")"]},void 0,!0,{fileName:o,lineNumber:37,columnNumber:15},this);case"todo":return e.exports.jsxDEV("div",{className:"text-warning",children:"\u672A\u5B8C\u6210"},void 0,!1,{fileName:o,lineNumber:42,columnNumber:20},this);case"abandoned":return e.exports.jsxDEV("div",{className:"text-danger",children:["\u5DF2\u653E\u5F03(",n.abandonedAt,")"]},void 0,!0,{fileName:o,lineNumber:45,columnNumber:15},this);default:return"--"}}},{title:"\u8BA1\u5212\u65E5\u671F",key:"planDate",render:(s,n)=>e.exports.jsxDEV("div",{children:[h(n.planDate).format("YYYY-MM-DD"),n.planStart&&n.planEnd&&`${h(n.planStart).format("YYYY-MM-DD")}
             - ${h(n.planEnd).format("YYYY-MM-DD")}`]},void 0,!0,{fileName:o,lineNumber:56,columnNumber:9},this)},{title:"\u7D27\u6025\u7A0B\u5EA6",key:"urgency",render:(s,n)=>{var m;return e.exports.jsxDEV("div",{children:((m=y.get(n.urgency))==null?void 0:m.label)||"--"},void 0,!1,{fileName:o,lineNumber:69,columnNumber:9},this)}},{title:"\u91CD\u8981\u7A0B\u5EA6",key:"importance",render:(s,n)=>{var m;return e.exports.jsxDEV("div",{children:((m=V.get(n.importance))==null?void 0:m.label)||"--"},void 0,!1,{fileName:o,lineNumber:76,columnNumber:9},this)}},{title:"\u6807\u7B7E",dataIndex:"tags",key:"tags"},{title:e.exports.jsxDEV("span",{className:"text-text-1 font-[500] px-4",children:"\u64CD\u4F5C"},void 0,!1,{fileName:o,lineNumber:81,columnNumber:14},this),key:"action",render:(s,n)=>e.exports.jsxDEV("div",{children:[e.exports.jsxDEV(b,{type:"text",onClick:()=>{C({title:e.exports.jsxDEV("div",{className:"text-body-3",children:"\u7F16\u8F91"},void 0,!1,{fileName:o,lineNumber:89,columnNumber:24},this),content:e.exports.jsxDEV("div",{className:"ml-[-6px]",children:e.exports.jsxDEV(_,{todo:n,onClose:null,onChange:async()=>{console.log("onChange")}},void 0,!1,{fileName:o,lineNumber:92,columnNumber:21},this)},void 0,!1,{fileName:o,lineNumber:91,columnNumber:19},this),onCancel:()=>{u()}})},children:"\u7F16\u8F91"},void 0,!1,{fileName:o,lineNumber:85,columnNumber:11},this),e.exports.jsxDEV(b,{type:"text",onClick:()=>L.confirm({title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",content:"\u5220\u9664\u540E\u5C06\u65E0\u6CD5\u6062\u590D",onOk:()=>{D.deleteTodo(n.id),u()}}),children:"\u5220\u9664"},void 0,!1,{fileName:o,lineNumber:109,columnNumber:11},this)]},void 0,!0,{fileName:o,lineNumber:84,columnNumber:9},this)}],[t,i]=E.exports.useState({}),[l,v]=E.exports.useState({}),F=async(s,n)=>{if(!n)return;v(c=>({...c,[s.id]:"loading"}));const m=await D.getTodoNode(s.id);i(c=>({...c,[s.id]:m})),v(c=>({...c,[s.id]:"loaded"}))};return e.exports.jsxDEV(e.exports.Fragment,{children:e.exports.jsxDEV(I,{className:"w-full",columns:d,data:p,pagination:!1,rowKey:"id",onExpand:F,expandedRowRender:s=>{var n,m,c;if(l[s.id]==="unLoading")return!0;if(l[s.id]==="loading")return e.exports.jsxDEV(j,{loading:l[s.id]==="loading"},void 0,!1,{fileName:o,lineNumber:161,columnNumber:15},this);if(l[s.id]==="loaded")return(m=(n=t[s.id])==null?void 0:n.subTodoList)!=null&&m.length?e.exports.jsxDEV(j,{children:(c=t[s.id])==null?void 0:c.subTodoList.map(T=>T.name).join(",")},void 0,!1,{fileName:o,lineNumber:168,columnNumber:15},this):null}},void 0,!1,{fileName:o,lineNumber:150,columnNumber:7},this)},void 0,!1)}var r="/Users/xuwenhua/code/project/home-manage/src/pages/todo/todo-all/index.tsx";function H(){const p=E.exports.useRef(null),{todoList:u,getTodoList:d}=g();return e.exports.jsxDEV(f,{className:"bg-bg-2 rounded-lg w-full h-full",children:[e.exports.jsxDEV(f.Fixed,{className:"px-5 py-2 flex justify-between items-center border-b",children:e.exports.jsxDEV("div",{className:"text-text-1 text-title-2 font-[500] py-1",children:"\u5168\u90E8\u5F85\u529E"},void 0,!1,{fileName:r,lineNumber:23,columnNumber:9},this)},void 0,!1,{fileName:r,lineNumber:22,columnNumber:7},this),e.exports.jsxDEV(f.Fixed,{className:"px-5 flex border-b",children:e.exports.jsxDEV($,{},void 0,!1,{fileName:r,lineNumber:27,columnNumber:9},this)},void 0,!1,{fileName:r,lineNumber:26,columnNumber:7},this),e.exports.jsxDEV(f.Fixed,{className:"px-5 flex my-3",children:e.exports.jsxDEV(b,{type:"primary",onClick:()=>{C({title:e.exports.jsxDEV("div",{className:"text-title",children:"\u6DFB\u52A0\u5F85\u529E"},void 0,!1,{fileName:r,lineNumber:35,columnNumber:22},this),content:e.exports.jsxDEV(O,{onChange:t=>{p.current=t},onSubmit:async t=>{var i,l;await D.addTodo({name:t.name,importance:t.importance,urgency:t.urgency,planDate:t.planDate||void 0,planStartAt:((i=t.planTimeRange)==null?void 0:i[0])||void 0,planEndAt:((l=t.planTimeRange)==null?void 0:l[1])||void 0,recurring:t.recurring,tags:t.tags}),d()}},void 0,!1,{fileName:r,lineNumber:37,columnNumber:17},this),onOk:async()=>{var i,l;const t=p.current;await D.addTodo({name:t.name,importance:t.importance,urgency:t.urgency,planDate:t.planDate||void 0,planStartAt:((i=t.planTimeRange)==null?void 0:i[0])||void 0,planEndAt:((l=t.planTimeRange)==null?void 0:l[1])||void 0,recurring:t.recurring,tags:t.tags}),d()}})},children:e.exports.jsxDEV("div",{className:"flex items-center gap-2",children:[e.exports.jsxDEV(Y,{id:"add",width:14,height:14},void 0,!1,{fileName:r,lineNumber:74,columnNumber:13},this),"\u65B0\u5EFA"]},void 0,!0,{fileName:r,lineNumber:73,columnNumber:11},this)},void 0,!1,{fileName:r,lineNumber:31,columnNumber:9},this)},void 0,!1,{fileName:r,lineNumber:30,columnNumber:7},this),e.exports.jsxDEV(f.Shrink,{className:"px-5 w-full h-full flex",children:e.exports.jsxDEV(G,{},void 0,!1,{fileName:r,lineNumber:81,columnNumber:9},this)},void 0,!1,{fileName:r,lineNumber:80,columnNumber:7},this)]},void 0,!0,{fileName:r,lineNumber:21,columnNumber:5},this)}function pe(){return e.exports.jsxDEV(R,{children:e.exports.jsxDEV(H,{},void 0,!1,{fileName:r,lineNumber:90,columnNumber:7},this)},void 0,!1,{fileName:r,lineNumber:89,columnNumber:5},this)}export{pe as default};
