import{r as o,j as h}from"./index.295caa00.js";import{T as c}from"./api.b8516001.js";var C="/Users/xuwenhua/code/project/home-manage/src/pages/todo/components/TodoDetail/context.tsx";const m=o.exports.createContext(void 0);function w(t){function u(e){return{name:e.name,description:e.description,tags:e.tags,importance:e.importance,urgency:e.urgency,planDate:e.planDate,planTimeRange:[e.planStartAt,e.planEndAt],recurring:e.recurring,subTodoList:e.subTodoList}}function p(e){var n,T;return{name:e.name,description:e.description,tags:e.tags,importance:e.importance,urgency:e.urgency,planDate:e.planDate,planStartAt:(n=e.planTimeRange)==null?void 0:n[0],planEndAt:(T=e.planTimeRange)==null?void 0:T[1],recurring:e.recurring,id:a.id,createdAt:a.createdAt,status:a.status,subTodoList:a.subTodoList}}const[g,r]=o.exports.useState(),[a,d]=o.exports.useState(t.todo),s=o.exports.useRef(),x=async e=>{const n=await c.getTodoNode(e.id);d(n),s.current=n,r(u(s.current))},i=o.exports.useCallback(async()=>{const e=await c.getTodoNode(t.todo.id);d(e),s.current=e,r(u(s.current))},[t.todo]);o.exports.useEffect(()=>{i()},[i]);let l=null;t.onClose&&(l=async()=>{r(null),await t.onClose()});async function f(e){r(e);const n=p(e);await c.updateTodo(n.id,n),await t.onChange(n)}return h.exports.jsxDEV(m.Provider,{value:{todoNode:a,todoFormData:g,setTodoFormData:r,onClose:l,onChange:f,refreshTodoFormData:x,initTodoFormData:i},children:t.children},void 0,!1,{fileName:C,lineNumber:107,columnNumber:5},this)}function b(){const t=o.exports.useContext(m);if(!t)throw new Error("useTodoDetailContext must be used within a TodoDetailProvider");return t}export{w as TodoDetailProvider,b as useTodoDetailContext};
